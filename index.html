<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Justconfig by asafh</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Justconfig</h1>
        <p>The Justconfig library provides easy access to configuration properties using interface proxy instances</p>

        <p class="view"><a href="https://github.com/asafh/justconfig">View the Project on GitHub <small>asafh/justconfig</small></a></p>


        <ul>
          <li><a href="https://github.com/asafh/justconfig/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/asafh/justconfig/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/asafh/justconfig">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>The Justconfig library</h1>

<p>The Justconfig library provides easy access to configuration properties. By simply specifying an interface describing your configuration values you can access those values without a hassle, independent of their source.<br>
Justconfig has no dependencies.
Check out the examples!</p>

<h2>Simple Example</h2>

<p>This example showcases a simple usage, leveraging annotation interfaces' ability to specify default values with method declaration</p>

<div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Simple</span>  <span class="o">{</span>  
    <span class="kd">private</span> <span class="kd">static</span> <span class="nd">@interface</span> <span class="n">ConfigSpecs</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="nf">poolSize</span><span class="o">()</span> <span class="k">default</span> <span class="mi">16</span><span class="o">;</span>
        <span class="n">String</span> <span class="nf">threadGroupName</span><span class="o">()</span> <span class="k">default</span> <span class="s">"myexecs"</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">ConfigSpecs</span> <span class="n">CONFIG</span> <span class="o">=</span> <span class="n">ConfigurationProxyHandlerBuilder</span><span class="o">.</span><span class="na">newBuilder</span><span class="o">().</span>
                                                <span class="n">configuration</span><span class="o">(</span><span class="k">new</span> <span class="n">SystemPropertiesConfigurationSource</span><span class="o">())</span>
                                                <span class="o">.</span><span class="na">build</span><span class="o">(</span><span class="n">ConfigSpecs</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
                                                <span class="o">.</span><span class="na">createProxy</span><span class="o">();</span>


    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span> <span class="n">String</span><span class="o">[]</span> <span class="n">args</span> <span class="o">)</span> <span class="kd">throws</span> <span class="n">InstantiationException</span><span class="o">,</span> <span class="n">IllegalAccessException</span><span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="s">"threadGroupName"</span><span class="o">,</span> <span class="s">"configuredValue"</span><span class="o">);</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="mi">16</span><span class="o">,</span> <span class="n">CONFIG</span><span class="o">.</span><span class="na">poolSize</span><span class="o">());</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"configuredValue"</span><span class="o">,</span> <span class="n">CONFIG</span><span class="o">.</span><span class="na">threadGroupName</span><span class="o">());</span>
    <span class="o">}</span>

<span class="o">}</span>


</pre></div>

<h2>More information</h2>

<p>There are a few, very simple, core concepts in Justconfig:  </p>

<ul>
<li>Configuration Sources</li>
<li>Configuration Spec</li>
<li>Value Reader Service</li>
<li>Proxy Handler</li>
</ul><h3>Configuration Sources</h3>

<p>A Configuration source retrieves simple values (Strings or primitives) for a String configuration property name. A simpler subset of <a href="http://commons.apache.org/configuration/">Apache Configuration</a> API's <a href="http://commons.apache.org/configuration/apidocs/org/apache/commons/configuration/Configuration.html">Configuration</a> interface.<br>
Justconfig comes out of the box with these configuration sources:  </p>

<ul>
<li>System Properties<br>
</li>
<li>java.util.Properties<br>
</li>
<li>Apache Configuration (optional dependency)</li>
</ul><p>New Configuration sources can be easily added by implementing the ConfigurationSource interface or extending the ConfigurationSourceBase class which helps with String backed configuration sources.</p>

<h3>Configuration Spec</h3>

<p>Configuration spec is your definition of what the configuration holds. You define one by defining an interface or an annotation like the following</p>

<div class="highlight"><pre><span class="kd">public</span> <span class="nd">@interface</span> <span class="n">ConfigSpecs</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="nf">poolSize</span><span class="o">()</span> <span class="k">default</span> <span class="mi">16</span><span class="o">;</span>
    <span class="n">String</span> <span class="nf">threadGroupName</span><span class="o">();</span>
<span class="o">}</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">ConfigSpecs2</span> <span class="o">{</span>
    <span class="n">Boolean</span> <span class="nf">poolSize</span><span class="o">();</span>
    <span class="n">String</span> <span class="nf">threadGroupName</span><span class="o">();</span>
<span class="o">}</span>
</pre></div>

<p>Justconfig will get you an instance of the interface, working just like how you think it will.  </p>

<p>If you're wondering why pick or not pick annotations over interfaces, these are the key differences:  </p>

<ul>
<li>Annotations let you specify default values in an convenient way<br>
</li>
<li>Annotations' methods' return types are limited to Strings, Enums, Classes and (not boxed) primitives. This also means all primitive values must either be explicitly set (in the configuration source) or a default value must be given (In the Configuration Spec) or a NullPointerException will be thrown on access to indicate the missing value<br>
</li>
<li>Annotaions unlike interface can't extends other annotations/interfaces.</li>
</ul><h3>Value Reader Services</h3>

<p>While the return types for methods in annotations are from a constant set, interfaces can have other return values.<br>
This is where Value Reader Services come in to play, an implementation accepts certain types that it can obtain from a configuration, and does so when such a value is requested.</p>

<p>Look at EnumValueReaderService for a simple example:</p>

<div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">EnumValueReaderService</span> <span class="kd">implements</span> <span class="n">ValueReaderService</span> <span class="o">{</span>

    <span class="cm">/**</span>
<span class="cm">     * return true iff the type is an enum.</span>
<span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">readable</span><span class="o">(</span><span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">type</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">Enum</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">isAssignableFrom</span><span class="o">(</span><span class="n">type</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**</span>
<span class="cm">     * Reads an enum constant using the enum's valueOf method</span>
<span class="cm">     */</span>
    <span class="nd">@SuppressWarnings</span><span class="o">({</span> <span class="s">"unchecked"</span> <span class="o">})</span>
    <span class="kd">public</span> <span class="n">Enum</span> <span class="nf">readValue</span><span class="o">(</span><span class="n">ClassLoader</span> <span class="n">loader</span><span class="o">,</span> <span class="n">ConfigurationSource</span> <span class="n">config</span><span class="o">,</span>
            <span class="n">String</span> <span class="n">name</span><span class="o">,</span> <span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">type</span><span class="o">)</span>
            <span class="kd">throws</span> <span class="n">IllegalArgumentException</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">enumName</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="n">name</span><span class="o">);</span>
        <span class="k">if</span><span class="o">(</span><span class="n">enumName</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Enum</span><span class="o">&gt;</span> <span class="n">eClass</span> <span class="o">=</span> <span class="n">type</span><span class="o">.</span><span class="na">asSubclass</span><span class="o">(</span><span class="n">Enum</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">Enum</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">eClass</span><span class="o">,</span> <span class="n">enumName</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>

<p>Justconfig by default looks for ValueReaderServices using Java's <a href="http://docs.oracle.com/javase/6/docs/api/java/util/ServiceLoader.html">ServiceLoader</a>, allowing you to easily implement value readers for more types or plug in libraries that do.</p>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/asafh">asafh</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-38567300-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>